<!DOCTYPE html>	
<main role="main" property="mainContentOfPage"> 
    <div class="container">
        <!-- Alerts -->
        <div class="alert alert-dismissible alert-warning">
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          <p class="mb-0">This app will not work if the document contains images.</p>
        </div>
        <p>This application is designed to transform Word procedures into HTML versions of themselves.<br>Every new update will require a hard refresh from the browser as the new script.js needs to be loaded.</p>
        <!-- File Input -->
        <input class="form-control" type="file" onchange="convertToHtml(this.files[0]);" id="fileInput" data-content="Select a file">
	    <button id="generate">Generate HTML</button>
        <!-- HTML Code Section -->
        <div class="row">
          <div class="col-12">
            <h2>HTML code:</h2>
            <code>
              <textarea
                rows="20"
                class="form-control"
                id="html-data"
                name="html-data"
                placeholder="HTML will appear here"
              ></textarea>
            </code>
          </div>
          <div class="col-12">
            <h2>Preview:</h2>
            <hr>
            <div id="output" class="well"></div>
          </div>
        </div>
      </div> 
</main>
<script src="script.js"></script>
	<script src="mammoth.browser.min.js"></script> 
	<script>
        function convertToHtml(file) {
            var reader = new FileReader();
            reader.onload = function(event) {
                var arrayBuffer = reader.result;
				var options = {
    ignoreEmptyParagraphs: true
};
                mammoth.convertToHtml({arrayBuffer: arrayBuffer}, options)
                    .then(function(result) {
                        document.getElementById('output').innerHTML = result.value;
					transformer();
                    })
                    .catch(function(err) {
                        console.log(err);
                    });
            };
            reader.readAsArrayBuffer(file);
			
        }
    </script>
</body>
</html>
